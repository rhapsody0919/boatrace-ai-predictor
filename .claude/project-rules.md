# プロジェクトルール

このプロジェクトで遵守すべきルールを記載します。

## Linear統合ルール（タスク管理）

### 運用方針

Claude Codeは **パターンA（自動管理）** で動作します：
- 実装タスクを受けた際に、自動的にLinearタスクを作成・更新する
- ユーザーが明示的にLinearタスク管理を指示しなくても、自動的に実行する

### 必須動作フロー

#### 🎯 実装タスクを受けた場合（バグ修正、機能追加など）

**1. タスク作成**
```bash
npm run linear:create "タスクのタイトル" "詳細な説明"
```
- タスクIDをメモする（例: BOAT-123）
- タイトルは簡潔に（例: "LINEシェアバグ修正"、"予測精度向上機能の追加"）
- 説明には実装内容や目的を記載

**2. タスクを「進行中」に更新**
```bash
npm run linear:update BOAT-123 "進行中" "実装を開始しました"
```

**3. 実装を進める**
- コードを書く、テストする
- 重要なマイルストーンに到達したらコメント追加:
```bash
npm run linear:comment BOAT-123 "進捗: UI部分の実装が完了"
```

**4. 実装完了後、タスクを「完了」に更新**
```bash
npm run linear:update BOAT-123 "完了" "実装完了。動作確認済み"
```

**5. コミット＆プッシュ**
- コミットメッセージにタスクIDを含める:
```bash
git commit -m "fix: LINEシェアバグ修正

Fixes BOAT-123

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>"
```

### 例外ケース

以下の場合はLinearタスクを作成しない:
- 単純な質問への回答（コード変更なし）
- ドキュメントの軽微な修正（typo修正など）
- 既存のLinearタスクIDを指定された場合（そのタスクを更新する）

### コミットメッセージのキーワード

- `Fixes BOAT-123` - タスクを完了状態にする
- `Refs BOAT-123` - タスクに関連付けるが完了しない
- `Related to BOAT-123` - 関連付けのみ

## 用語規則

### ❌ 禁止用語

以下の用語は **絶対に使用禁止** です：

- **「競艇」**: 使用しないでください
  - ✅ 正しい表記: **「ボートレース」**
  - 理由: ブランド統一のため、公式名称である「ボートレース」を使用する

### 適用範囲

この用語規則は以下の全てに適用されます：

- ソースコード（変数名、コメント、文字列リテラル）
- UI/UX テキスト
- ブログ記事・コンテンツ
- ドキュメント
- エラーメッセージ
- ログメッセージ
- コミットメッセージ
- ハッシュタグ・SNSシェアメッセージ

## コード修正時の注意

既存のコードやコンテンツを修正・追加する際は、必ず上記の用語規則に従ってください。

**例:**

```javascript
// ❌ 悪い例
const kyoteiData = fetchData();
hashtags: ['競艇', 'ボートレース']

// ✅ 良い例
const boatraceData = fetchData();
hashtags: ['ボートレース', 'AI予想']
```

## Git操作ルール

### コミット時の動作

Claude Codeがコミットを行う際は、以下のルールに従うこと：

**❌ 禁止事項:**
- コミット前に1、2、3のステップで確認を求めること
- ユーザーに対して過度に確認ステップを踏むこと

**✅ 推奨動作:**
- ユーザーがコミットを依頼した場合は、直接実行する
- 必要な情報（変更内容の確認、コミットメッセージの作成）を自動的に収集し、一度に実行する
- コミットメッセージには必ずタスクIDを含める（例：`Fixes BOAT-123`）
- コミットメッセージのフォーマット：
  ```
  <type>: <簡潔な説明>

  Fixes BOAT-XXX

  🤖 Generated with [Claude Code](https://claude.com/claude-code)

  Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>
  ```

### 例外ケース

以下の場合のみ、ユーザーに確認を求めてもよい：
- 非常に大きな変更で、コミットの分割が必要な場合
- セキュリティに関わる変更がある場合
- `.env`や認証情報ファイルなど、機密情報が含まれる可能性がある場合

## デザイン統一ルール

### 全体方針

**すべてのページで統一されたデザインを維持すること。**

### カラースキーム（厳守）

プロジェクト全体で以下のカラースキームを使用すること：

**主要カラー（青系）:**
- プライマリ：`#0ea5e9`（明るい青）
- セカンダリ：`#0284c7`（濃い青）
- グラデーション：`linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%)`

**背景色:**
- ページ背景：`#ffffff`（白）または`#f8fafc`（薄いグレー）
- カード背景：`#ffffff`（白）

**テキストカラー:**
- プライマリテキスト：`#1e293b`（濃いグレー）
- セカンダリテキスト：`#64748b`（グレー）
- ヘッダーテキスト：`#ffffff`（白）

### 共通コンポーネント

**ヘッダー:**
- すべてのページで`Header`コンポーネントを使用すること
- ヘッダーのスタイルを変更しないこと
- ヘッダーのグラデーション背景を変更しないこと

**レイアウト:**
- 最大幅：`1920px`
- コンテナの padding：`1.5rem 2rem`（モバイルでは調整可）

### 禁止事項

**❌ ページごとに以下を変えることを禁止:**
- 背景色（全ページで白または薄いグレーを使用）
- 主要なテキスト色
- ヘッダーのデザイン
- ブランドカラー（青系以外の色をメインカラーとして使用）

**❌ 新しいページやコンポーネントを作成する際:**
- 独自の背景色やテーマカラーを設定しないこと
- 既存のページと異なるフォントサイズ体系を使用しないこと
- 既存のデザインパターンから大きく逸脱しないこと

### 例

**❌ 悪い例:**
```css
.my-page {
  background: #ff5722; /* 赤系の背景 */
  color: #fff;
}

.my-header {
  background: linear-gradient(to right, #ff0000, #00ff00); /* 独自のグラデーション */
}
```

**✅ 良い例:**
```css
.my-page {
  background: #ffffff; /* 統一された白背景 */
  color: #1e293b; /* 統一されたテキストカラー */
}

/* 既存のHeaderコンポーネントを使用 */
import Header from '../components/Header';
```

### 新機能追加時の注意

新しいページやコンポーネントを追加する際は：
1. 既存のページ（`HowToUse.jsx`、`Blog.jsx`など）のデザインパターンを参考にする
2. `Header`コンポーネントを必ず含める
3. 既存のCSSファイルで定義されているカラー変数やスタイルを再利用する
4. 独自のデザインシステムを作成しない

### CSS色指定の重要ルール

**背景とテキストのコントラスト問題を防ぐため、以下を厳守すること：**

#### 1. 背景色タイプごとのテキスト色定義

| 背景色タイプ | テキスト色 | 適用場所 |
|------------|----------|---------|
| 白背景 `#ffffff` または `#f8fafc` | `#1e293b !important`（濃いグレー） | ページ本体、カード |
| グラデーション背景（青系） | `#ffffff !important`（白） | CTA、ヘッダー、強調セクション |
| 薄いグレー背景 `#f1f5f9`, `#e2e8f0` | `#1e293b !important`（濃いグレー） | サブセクション、ボックス |
| 青背景 `#0ea5e9` 系 | `#ffffff !important`（白） | ボタン、バッジ、アクセント |
| 暗い背景 `#1e293b` 系 | `#f1f5f9 !important`（薄いグレー） | コードブロック、暗いテーマ |

**重要：すべてのテキスト色には`!important`を付けて、継承による予期しない色の適用を防ぐこと**

#### 2. 必須ルール

1. **すべてのテキスト要素に明示的に色を指定する**
   - h1, h2, h3, h4, h5, h6, p, span, a などすべてのテキスト要素に`color`プロパティを明示的に設定
   - 親要素からの継承に依存しない
   - 必ず`!important`を使用する

2. **背景色とテキスト色を同時に設定する**
   - 背景色を変更する場合は、必ずテキスト色も同時に設定
   - 例：暗い背景には白文字、白背景には暗い文字

3. **CSSの詳細度問題を避ける**
   - グラデーション背景などの特殊な背景を持つ要素の子要素には`!important`を使用
   - 例：`.faq-cta h2 { color: white !important; }`

4. **修正後は必ず視覚的に確認**
   - コミット前にブラウザで実際の表示を確認する
   - 特に、CTAセクション、ヘッダー、カードなど背景色が異なる箇所を重点的にチェック

#### 3. よくある問題パターンと解決方法

**パターンA: グラデーション背景のセクション**

❌ **悪い例:**
```css
.section {
  background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
}
.section h2 { /* 色指定なし */ }
.section p { /* 色指定なし */ }
```

✅ **良い例:**
```css
.section {
  background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
  color: white; /* 親要素でデフォルトを設定 */
}
.section h1,
.section h2,
.section h3,
.section h4,
.section p,
.section span,
.section a {
  color: white !important; /* すべての子要素で明示 */
}
```

**パターンB: 白背景のセクション**

❌ **悪い例:**
```css
.section {
  background: #ffffff;
}
/* テキスト色が指定されていない */
```

✅ **良い例:**
```css
.section {
  background: #ffffff;
  color: #1e293b; /* 濃いグレー */
}
.section h1,
.section h2,
.section h3,
.section h4 {
  color: #1e293b !important;
}
.section p {
  color: #64748b !important; /* グレー */
}
```

**パターンC: テーブル**

❌ **悪い例:**
```css
table {
  background: #ffffff;
}
thead {
  background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
}
/* th, td の色が指定されていない */
```

✅ **良い例:**
```css
table {
  background: #ffffff;
}
thead {
  background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
}
th {
  color: #ffffff !important;
}
td {
  background: #ffffff;
  color: #1e293b !important;
}
```

#### 4. 実装チェックリスト

新しいページやコンポーネントを追加する際は、以下を確認：

- [ ] すべてのh1〜h6要素に`color: XXX !important;`を設定
- [ ] すべてのp要素に`color: XXX !important;`を設定
- [ ] グラデーション背景を持つ要素の子要素すべてに明示的な色を設定
- [ ] テーブルのth, tdに明示的な色を設定
- [ ] ボタン、バッジ、ラベルなどの特殊要素にも明示的な色を設定
- [ ] ブラウザで実際の表示を確認し、すべてのテキストが読める
