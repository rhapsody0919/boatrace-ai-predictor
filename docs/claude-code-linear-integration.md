# Claude Code × Linear統合ガイド

ターミナルで実行するClaude Codeで、コードを実装する際に自動的にLinearチケットを作成・更新する方法です。

## 🎯 概要

Claude Codeがコードを実装する際に、以下のように自動的にLinearチケットを操作します：

1. **実装開始時**: Linearチケットを作成し、「進行中」に更新
2. **実装中**: 進捗をコメントで記録
3. **実装完了時**: チケットを「完了」に更新

## 📋 セットアップ

### 1. 権限の確認

`.claude/settings.local.json` に以下の権限が追加されていることを確認：

```json
{
  "permissions": {
    "allow": [
      "Bash(npm run linear:*:)",
      "Bash(node scripts/linear-cli.js:*)"
    ]
  }
}
```

### 2. 環境変数の設定

Linear APIキーが設定されているか確認：

```bash
echo $LINEAR_API_KEY
```

設定されていない場合は：

```bash
export LINEAR_API_KEY="lin_api_xxxxxxxxxxxxx"
```

## 🚀 使用方法

### 基本的な使い方

Claude Codeを実行する際に、プロンプトにLinear統合の指示を追加します：

```bash
claude-code "予測機能の精度を向上させる機能を実装してください。

【Linear統合】
- 実装開始時にLinearチケットを作成（タイトル: 予測機能の精度向上）
- チケットを「進行中」に更新
- 実装完了時にチケットを「完了」に更新
- 重要な進捗はコメントで記録"
```

### プロンプトテンプレート

#### 機能実装

```
以下の機能を実装してください。

【機能名】
[機能の説明]

【実装手順】
1. Linearチケットを作成
   - タイトル: [機能名]
   - 説明: [詳細な説明]
   - コマンド: npm run linear:create "[機能名]" "[説明]"

2. チケットを「進行中」に更新
   - コマンド: npm run linear:update [チケットID] "進行中" "実装を開始"

3. 実装を開始
   - [実装内容]

4. 重要なマイルストーンに到達したらコメントを追加
   - コマンド: npm run linear:comment [チケットID] "進捗: [内容]"

5. 実装完了時にチケットを「完了」に更新
   - コマンド: npm run linear:update [チケットID] "完了" "実装完了"
```

#### バグ修正

```
以下のバグを修正してください。

【バグの説明】
[バグの詳細]

【実装手順】
1. Linearチケットを作成
   - タイトル: バグ修正: [バグ名]
   - 説明: [詳細]
   - コマンド: npm run linear:create "バグ修正: [バグ名]" "[説明]"

2. チケットを「進行中」に更新

3. 原因を調査し、コメントに記録
   - コマンド: npm run linear:comment [チケットID] "原因: [調査結果]"

4. 修正を実施

5. テストを実施

6. チケットを「完了」に更新
   - コマンド: npm run linear:update [チケットID] "完了" "修正完了"
```

#### リファクタリング

```
以下のコードをリファクタリングしてください。

【対象】
[リファクタリング対象の説明]

【実装手順】
1. Linearチケットを作成
   - タイトル: リファクタリング: [対象]
   - 説明: [詳細]
   - コマンド: npm run linear:create "リファクタリング: [対象]" "[説明]"

2. チケットを「進行中」に更新

3. リファクタリングを実施

4. テストを実施

5. チケットを「完了」に更新
```

## 💡 実践例

### 例1: 機能実装

```bash
claude-code "予測アルゴリズムのパフォーマンスを改善する機能を実装してください。

【Linear統合】
1. Linearチケットを作成（タイトル: 予測アルゴリズムのパフォーマンス改善）
2. チケットを「進行中」に更新
3. 実装を開始
4. 実装完了時にチケットを「完了」に更新"
```

**Claude Codeの動作:**
1. `npm run linear:create "予測アルゴリズムのパフォーマンス改善" "..."` を実行
2. チケットID（例: `BIZ-123`）を取得
3. `npm run linear:update BIZ-123 "進行中" "実装を開始"` を実行
4. 実装を開始
5. 実装完了時に `npm run linear:update BIZ-123 "完了" "実装完了"` を実行

### 例2: バグ修正

```bash
claude-code "ログイン機能でエラーが発生する問題を修正してください。

【Linear統合】
1. Linearチケットを作成（タイトル: バグ修正: ログイン機能のエラー）
2. チケットを「進行中」に更新
3. 原因を調査し、コメントに記録
4. 修正を実施
5. テストを実施
6. チケットを「完了」に更新"
```

## 🔧 自動化のヒント

### プロンプトファイルを使用

`.claude/linear-integration.md` を参照して、自動的にLinear統合を行う：

```bash
claude-code --prompt .claude/linear-integration.md "予測機能を実装してください"
```

### 環境変数の確認

Claude Code実行前に、Linear APIキーが設定されているか確認：

```bash
if [ -z "$LINEAR_API_KEY" ]; then
  echo "❌ LINEAR_API_KEYが設定されていません"
  exit 1
fi

claude-code "機能を実装してください..."
```

## 📝 注意事項

- Linear APIキーが設定されていない場合、チケットの作成・更新はスキップされます
- チケットIDは、作成後に自動的に記録されます
- 実装中に気づいたことは、新しいチケットとして作成できます

## 🚀 次のステップ

1. `.claude/settings.local.json` に権限を追加（完了済み）
2. Linear APIキーを設定（完了済み）
3. Claude Codeで実装を試す

---

これで、Claude Codeがコードを実装する際に、自動的にLinearチケットを管理できるようになります！

