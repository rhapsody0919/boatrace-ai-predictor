# ボートレースAI予測アプリケーション - 機能要件一覧

## プロジェクト概要

ボートレースの実データを取得し、簡易的なAI予測機能でレース結果の推奨を提供するWebアプリケーション。React + Viteで構築し、Vercelで公開する。

## 1. レースデータ取得・表示機能

### 1.1 レースデータスクレイピング
- **要件ID**: FR-001
- **優先度**: 高
- **説明**: ボートレース公式サイトからWebスクレイピングでリアルタイムのレースデータを取得する
- **詳細**:
  - スクレイピング対象: `https://www.boatrace.jp/owpc/pc/race`
  - 実装方法: Vercelサーバーレス関数（API Routes）を使用
  - 取得データ: レース日付、レース場番号、レース番号、選手情報など
  - **スクレイピングマナー遵守**:
    - User-Agentを適切に設定
    - リクエスト頻度を制限（キャッシュ機能の実装）
    - robots.txtを尊重
    - エラー時は即座にフォールバック
  - エラーハンドリング: スクレイピング失敗時のエラーメッセージ表示
  - フォールバック: 取得失敗時はサンプルデータを表示
  - **注意**: 利用規約を遵守し、サーバーに過度な負荷をかけない実装とする

### 1.2 レース場情報表示
- **要件ID**: FR-002
- **優先度**: 高
- **説明**: 全国24のボートレース場の情報を表示する
- **詳細**:
  - レース場一覧: 桐生、戸田、江戸川、平和島、多摩川、浜名湖、蒲郡、常滑、津、びわこ、住之江、尼崎、鳴門、丸亀、児島、宮島、徳山、下関、若松、芦屋、福岡、唐津、大村、桐生（24場）
  - レース場番号から名称へのマッピング機能

### 1.3 レース場選択機能
- **要件ID**: FR-003
- **優先度**: 高
- **説明**: ユーザーがレース場を選択してレース一覧を絞り込む
- **詳細**:
  - レース場選択UI: ドロップダウン（セレクトボックス）形式
  - 全24レース場から選択可能
  - デフォルト表示: 最初に開催されているレース場、または「レース場を選択してください」
  - 選択変更時に即座にレース一覧を更新
  - レース場ごとにデータが存在しない場合は「本日は開催なし」と表示

### 1.4 レース一覧表示
- **要件ID**: FR-004
- **優先度**: 高
- **説明**: 選択したレース場の当日開催レース一覧を時系列で表示する
- **詳細**:
  - 表示項目: レース番号、発走時刻、天候、波高、風速
  - レース番号: 1R～12R
  - 発走時刻の計算: 1Rは10:30から30分間隔
  - データ取得状況の表示: 「実データ取得」または「サンプルデータ」の明示
  - 選択したレース場のレースのみを表示（全レース場を同時表示しない）

### 1.5 データ変換・整形ロジック
- **要件ID**: FR-005
- **優先度**: 高
- **説明**: API レスポンスをアプリケーション内部形式に変換する
- **詳細**:
  - レース場番号から名称への変換
  - 発走時刻の計算と整形（HH:MM形式）
  - レース場ごとのグループ化処理
  - 全24レース場のデータを保持（表示は選択したレース場のみ）

## 2. AI予測機能（簡易実装）

### 2.1 レース選択機能
- **要件ID**: FR-006
- **優先度**: 高
- **説明**: ユーザーがレース一覧から予測したいレースを選択できる
- **詳細**:
  - 「AI予想を見る」ボタンの配置
  - 選択したレース情報の保持

### 2.2 AI分析実行
- **要件ID**: FR-007
- **優先度**: 中
- **説明**: 選択したレースに対して簡易的な予測分析を実行する
- **詳細**:
  - 分析処理中のローディング表示（スピナーアニメーション）
  - 分析メッセージ: 「AIが分析中...」「過去データ、モーター性能、気象条件を解析しています」
  - 簡易的な予測ロジックによる結果生成

### 2.3 予測結果表示
- **要件ID**: FR-008
- **優先度**: 高
- **説明**: AI分析の結果をユーザーにわかりやすく表示する
- **詳細**:
  - **AI信頼度**: パーセンテージとプログレスバーで表示
  - **本命予想（トップピック）**:
    - 艇番
    - 選手名
    - 年齢
    - 勝率
    - モーター勝率
    - AIスコア（強調表示）
  - **予想根拠**: 箇条書きリストで根拠を明示
  - **全艇情報テーブル**:
    - 6艇すべての情報を表形式で表示
    - カラム: 艇番、選手名、年齢、勝率、モーター勝率、AIスコア
    - 推奨艇（1-3番艇）のハイライト表示

### 2.4 予測データ生成
- **要件ID**: FR-009
- **優先度**: 中
- **説明**: 簡易的なロジックで予測データを生成する
- **詳細**:
  - サンプル選手データの生成（名前、年齢、勝率など）
  - AIスコアの算出
  - 信頼度のランダム生成（70-95%）
  - 予想根拠の文章生成

## 3. 広告表示機能

### 3.1 広告バナー配置
- **要件ID**: FR-010
- **優先度**: 中
- **説明**: アプリケーション内の複数箇所に広告バナーを配置する
- **詳細**:
  - **ヘッダー広告**: 728x90ピクセル（一般バナーサイズ）
  - **サイドバー広告（左）**: 160x600ピクセル（ワイドスカイスクレイパー）
  - **サイドバー広告（右）**: 160x600ピクセル（ワイドスカイスクレイパー）
  - **コンテンツ内広告**: 728x90ピクセル（レース場関連広告）
  - **フッター広告**: 728x90ピクセル（ボート用品・グッズ広告）

### 3.2 広告プレースホルダー
- **要件ID**: FR-011
- **優先度**: 低
- **説明**: 開発段階では広告プレースホルダーを表示する
- **詳細**:
  - プレースホルダーテキスト: 「📢 広告スペース (サイズ) - 広告種類」
  - 背景色とボーダーで視覚的に区別

## 4. UI/UXコンポーネント

### 4.1 レスポンシブデザイン
- **要件ID**: FR-012
- **優先度**: 高
- **説明**: デスクトップ、タブレット、モバイルで適切に表示される
- **詳細**:
  - 3カラムレイアウト（サイドバー左、メインコンテンツ、サイドバー右）
  - モバイルでは1カラムに自動調整
  - 広告バナーのレスポンシブ配置

### 4.2 ローディング状態表示
- **要件ID**: FR-013
- **優先度**: 中
- **説明**: データ取得中や分析中の状態をユーザーにフィードバックする
- **詳細**:
  - 初期ロード: 「レースデータを取得中...」
  - AI分析中: スピナーアニメーション + 分析メッセージ

### 4.3 エラーハンドリングとフィードバック
- **要件ID**: FR-014
- **優先度**: 高
- **説明**: エラー発生時にユーザーにわかりやすいメッセージを表示する
- **詳細**:
  - APIエラー時のメッセージ表示
  - エラー内容の明示
  - フォールバック処理の自動実行

### 4.4 状態管理
- **要件ID**: FR-015
- **優先度**: 高
- **説明**: React の useState/useEffect でアプリケーション状態を管理する
- **詳細**:
  - 管理対象状態:
    - `selectedRace`: 選択されたレース
    - `prediction`: 予測結果
    - `isAnalyzing`: 分析中フラグ
    - `loading`: ローディングフラグ
    - `error`: エラー情報
    - `isRealData`: 実データ取得フラグ
    - `races`: レース一覧データ

## 5. デプロイメント

### 5.1 Vercel デプロイ
- **要件ID**: FR-016
- **優先度**: 高
- **説明**: Vercel で静的サイトとして公開する
- **詳細**:
  - Vite ビルドプロセスの実行
  - `dist/` ディレクトリの生成
  - Vercel による自動デプロイ（GitHubリポジトリ連携）
  - プレビューデプロイメント機能の活用
  - カスタムドメインの設定（オプション）

### 5.2 ビルド最適化
- **要件ID**: FR-017
- **優先度**: 中
- **説明**: 本番環境用に最適化されたビルドを生成する
- **詳細**:
  - コードの圧縮（minification）
  - ツリーシェイキング
  - CSS の最適化
  - アセットの最適化

## 6. 免責事項と著作権表示

### 6.1 免責事項
- **要件ID**: FR-018
- **優先度**: 高
- **説明**: フッターに免責事項を表示する
- **詳細**:
  - 表示内容: 「※本サイトはAIによる予想を提供するものであり、的中を保証するものではありません」

### 6.2 著作権表示
- **要件ID**: FR-019
- **優先度**: 中
- **説明**: フッターに著作権表示を配置する
- **詳細**:
  - 表示内容: 「© 2025 ボートレースAI予想 - All Rights Reserved」

## 非機能要件

### パフォーマンス
- ページ初回ロード時間: 3秒以内
- API データ取得タイムアウト: 10秒
- AI分析処理時間: 2秒以内（簡易実装のため）

### ブラウザ互換性
- Chrome（最新版）
- Firefox（最新版）
- Safari（最新版）
- Edge（最新版）

### セキュリティ
- HTTPS での配信（Vercel デフォルト）
- XSS対策（Reactのデフォルト機能）
- 外部APIへの適切なエラーハンドリング

## 今後の拡張候補（Phase 2以降）

- ユーザー登録・ログイン機能
- 予測履歴の保存と閲覧
- より高度なAI予測アルゴリズム
- リアルタイム更新機能（WebSocket）
- 過去レース結果の検索・分析
- お気に入りレース場の登録
- プッシュ通知機能

---

**文書作成日**: 2025-11-27
**対象プロジェクト**: ボートレースAI予測アプリケーション
**バージョン**: 1.0
